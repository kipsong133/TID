# Today, I learned: TCP, IP 그리고 HTTP

**TCP 란**

- TCP = Transmission Control Protocol (전송을 제어하는 프로토콜)

- 인터넷 상에서 데이터를 메시지 형태로 보내기 위해 IP와 함께 사용하는 프로토콜

- TCP는 패킷을 추척관리하고, IP는 데이터를 배달을 처리한다.

  - cf) 패킷 : Pack + Bucket 의 합성어로, 우체국에서 화물들을 보낼 때, 행선지를 표시하는 꼬리표를 붙이는 것으로 생각할 수 있다. 데이터를 보낼 때, 한 번에 보내는 것이 아니라 데이터를 나눠서 보내개 된다. 나눠서 보내는 이유는 한 번에 보내게 되면 대역폭을 많이 자치하고 트래픽이 증가하게 된다. 그러므로 패킷으로 나눠서 보내게 된다. 다만, 나눠서 보내고 다시 합치는 과정에서 정확하게 데이터를 나열해야 원하는 데이터가 정상적으로 전달될 것이므로, 패킷의 개념을 사용하게된다. 이것을 "패킷 교환 방식" 이라고 한다.

- TCP는 연결형 서비스로 "가상회선 방식" 을 제공한다.

- 높은 신뢰도를 보장한다. 왜냐하면, 앞서 지나간 패킷들의 길을 그대로 지나가기 때문이다.

- UDP보다 속도가 느리다.
- 서버와 클라이언트는 1:1로 연결한다.
- 스트림 전송으로 전송 데이터 크기가 무제한이다.
- 패킷에 대한 응답을 처리해야하므로 시간 지연이나 CPU소모가 발생하고 그로인해 성능이 낮다.
- Streaming 서비스에 불리하다. (손실되게 되면, 재전송을 해야하므로)



### TCP / IP의 계층 그리고 HTTP와 TCP / IP의 관계

TCP / IP는 "응용프로그램 계층", "전송 계층", "네트워크 계층" 그리고 "연결 계층" 으로 총 4 개의 계층이 있다.

<img width="606" alt="image" src="https://user-images.githubusercontent.com/65879950/152146596-a97ebb11-bc4e-4fbb-90ca-f98ea7dd6e5c.png">


<img width="971" alt="image" src="https://user-images.githubusercontent.com/65879950/152146623-38286a73-859f-4fa6-aac8-12fd5ddc2245.png">


- TCP / IP로 통신하면 계층의 순서에 따라 상대방과 통신하게된다.
- 출발지에서 출발 -> 응용프로그램 계층 -> 도착지
- 도착지에서 출발 -> 응용프로그램 -> 출발지 

#### HTTP란

네트워크 통신을 하기 위해서 정해진 "절차" 와 "형식"이 필요하다. 왜냐하면, 자신의 마음대로 보내게 된다면, 송수신을 할 때, 문제가 발생하기 때문이다. 그러므로 이것들을 미리 정한 약속을 HTTP(Hyper-Text-Transport-Protocol) 라고 한다. WWW를 구성하는 기술은 문서를 작성하는 HTML, 문서 전송 프로토콜인 HTTP, 그리고 문서으 위치를 지정하는 URL로 제안하고 있다.



#### HTTP 예시

1. 출발지는 클라이언트의 응용프로그램 계층(HTTP) 에서 특정 웹페이지를 보기위해 HTTP 요청을 한다.
2. 전송계층(TCP, 위 그림의 트랜스포트 계층)에서 받은 데이터를 통신하기 좋은 크기(패킷)으로 자른 후, 네트워크 계층으로 전달한다. (인터넷 계층)
3. 네트워크 계정(IP)에서는 전송할 곳의 IP 주소를 추가하고 연결계층으로 전달한다. 이것으로 네트워크를 통해 HTTP 요청을 전달할 준비가 끝난다.
4. 도착지 서버에서는 연결계층에서 데이터를 받아서 상위 계층으로 전달해 응용프로그램 계층까지 전달한다.
5. 응용 프로그램에 도착하면 클라이언트가 보낸 HTTP 요청 내용을 받을 수 있다.



#### 전송을 담당하는 IP

- IP는 계층으로 따지면 네트워크 계층이다.
- IP(=Internet Protocol) 이라는 이름에 맞게, 인터넷을 사용하는 모든 시스템이 IP를 사용하고 있다.
- IP 역할은 패킷들을 상대방에게 전달하는 것이다.
- 패킷이 전달되기 위해서는 각 노드의 위치를 나타내는 IP주소가 있어야 한다.
- 목적지까지 중계해주는 도중의 컴퓨터 또는 라우터와 같은 네트워크 장비는 목직지에 도착하기 위한 대략적인 행선지만 알고 있고 이러한 구조를 라우팅이라고 한다.
- ex) 택배 배달을 하게 되면, 택배를 보내는 사람이 짐을 보내기 위해 택배 접수하는 곳에 가야한다. 택배 접수처는 이 짐을 어느 지역에 보내야하는지 알고 있다. 해당 지역의 물류창고는 대략적인 위치를 바탕으로 각 배달원들에게 짐을 할당한다. 배달원들은 운송장을 보고 집이 어디에 배달되어야 하는지 정확히 할 수 있다. 이처럼, 디테일한 정보를 모르지만, 원하는 곳으로 택배를 보낼 수 있다.



#### 신뢰성을 담당하는 TCP

- TCP는 전송계층에 해당하는 프로토콜로 신뢰성을 가지는 "바이트 스트림"을 사용한다.
- 바이트스트림ㅇㄴ 커다란 데이터를 보내기 쉽도록 TCP 세그먼트라고 하는 단위의 "패킷"으로 잘게 나눠서 보낸다.
- 각 패킷에서는 번호가 붙어있기 때문에 누락된 패킷이 있는지 검증할 수 있고, 신뢰도를 담보할 수 있다.
- TCP는 큰 데이터를 보내기 쉽게 처리한 이후 상대방에게 잘 도착했는지 확인하는 역할을 한다.
- TCP는 패킷에 플래그를 갖게 되는데, 플래그를 변경해서 몇 가지의 기능들도 사용이 가능하다.
- 그 기능 중 확실하게 상대방에게 데이터를 전달하는 방법이 `3way hand shaking` 이다.

<img width="1152" alt="image" src="https://user-images.githubusercontent.com/65879950/152146668-f6ac7cc9-6304-4d35-9e07-2866abcdca77.png">




#### 이름 변환을 담당하는 DNS

- 네트워크를 이용하는 컴퓨터는 IP주소와는 별개로 호스트이름인 www를 붙일 수 있다.
- DNS는 HTTP와 같은 응용프로그램 계층 시스템으로 주로 호스트이름이나 도메인 이름 IP주소의 이름을 변환한다.
- 이를 통해서 사람이 인식하기 쉽게 도와준다.

<img width="1107" alt="image" src="https://user-images.githubusercontent.com/65879950/152146693-1462b064-f26a-4c27-b558-56ca80d6d927.png">


